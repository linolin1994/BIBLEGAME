<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è–ç¶“ç¶“æ–‡è¨˜æ†¶éŠæˆ²</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- æ–°çš„è‰²å½©ä¸»é¡Œ --- */
        :root {
            --bg-main: #EEEFE0; /* é é¢ä¸»èƒŒæ™¯ */
            --bg-card: #D1D8BE; /* å¡ç‰‡èƒŒæ™¯ */
            --text-accent: #84AE92; /* å¼·èª¿æ–‡å­—ã€æ¬¡è¦æŒ‰éˆ• */
            --text-primary: #5A827E; /* ä¸»è¦æ–‡å­—ã€ä¸»è¦æŒ‰éˆ• */
            --text-light: #f8f9fa; /* äº®è‰²æ–‡å­—(ç”¨æ–¼æŒ‰éˆ•) */
            --border-color: #c1c8a7; /* é‚Šæ¡†é¡è‰² */
            --correct-green: #5a9a74; /* æ­£ç¢ºç­”æ¡ˆçš„ç¶ è‰² */
            --incorrect-red: #d97d5d; /* éŒ¯èª¤ç­”æ¡ˆçš„æ©˜ç´…è‰² */
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-main);
        }
        #game-container {
            background-color: var(--bg-card);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        /* è‡ªå®šç¾©è¼¸å…¥æ¡†å‹•ç•« */
        .correct-answer {
            border-color: var(--correct-green);
            background-color: #f0fdf4;
            box-shadow: 0 0 5px var(--correct-green);
        }
        .incorrect-answer {
            border-color: var(--incorrect-red);
            background-color: #fff6f2;
            box-shadow: 0 0 5px var(--incorrect-red);
        }
        .input-blank {
            transition: all 0.3s ease-in-out;
            margin: 2px 4px;
            padding: 2px 4px;
            text-align: center;
            border-radius: 6px;
            border: 2px solid var(--border-color);
            background-color: rgba(255, 255, 255, 0.7);
        }
        .input-blank::placeholder {
            color: #a1a1aa; /* zinc-400 */
            font-weight: 400;
            letter-spacing: 0.1em;
        }
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%235A827E' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
            padding-right: 3rem; 
        }
        /* æŒ‰éˆ•ç¦ç”¨æ™‚çš„æ¨£å¼ */
        button:disabled {
            background-color: #a1a1aa; /* zinc-400 */
            border-color: #a1a1aa;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* --- æŒ‰éˆ•é¡è‰²è¦†è“‹ --- */
        #prev-btn, #next-btn { background-color: var(--text-accent); }
        #prev-btn:hover, #next-btn:hover { background-color: #739d82; }

        #check-btn, #shuffle-btn { background-color: var(--text-primary); }
        #check-btn:hover, #shuffle-btn:hover { background-color: #4a6d69; }
        
        #show-btn { background-color: #b0b8a0; color: #3f3f46; }
        #show-btn:hover { background-color: #a0aa90; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div id="game-container" class="p-4 sm:p-6 md:p-8 rounded-2xl shadow-xl w-full max-w-4xl text-center">
        <h1 class="text-2xl sm:text-3xl font-bold text-[#4a6d69] mb-2">è–ç¶“ç¶“æ–‡è¨˜æ†¶éŠæˆ²</h1>
        <p class="text-sm sm:text-base text-gray-600 mb-6">è©¦è‘—å¡«å…¥ç¶“æ–‡ä¸­ç©ºç™½çš„éƒ¨åˆ†å§ï¼</p>

        <div class="mb-6 w-full max-w-md mx-auto">
            <label for="verse-select" class="sr-only">é¸æ“‡ç¶“æ–‡:</label>
            <select id="verse-select" class="w-full border rounded-md p-2 bg-white/70 shadow-sm focus:ring-sky-500 focus:border-sky-500" style="border-color: var(--border-color); color: var(--text-primary);">
            </select>
        </div>

        <div id="verse-reference" class="text-base sm:text-lg md:text-xl font-semibold mb-4" style="color: var(--text-primary);"></div>
        
        <div id="verse-display" class="text-lg sm:text-xl md:text-2xl leading-relaxed sm:leading-loose text-gray-800 p-4 border rounded-lg mb-6 bg-white/50 min-h-[120px] flex flex-wrap justify-center items-center" style="border-color: var(--border-color);">
            <!-- ç¶“æ–‡å…§å®¹æœƒå‹•æ…‹ç”Ÿæˆæ–¼æ­¤ -->
        </div>

        <div id="message-area" class="h-8 mb-6 text-base sm:text-lg font-medium"></div>

        <div class="flex flex-wrap gap-3 justify-center">
            <button id="prev-btn" class="flex-grow text-white sm:flex-grow-0 font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition-colors duration-300 shadow-md">ä¸Šä¸€é¡Œ</button>
            <button id="check-btn" class="flex-grow text-white sm:flex-grow-0 font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition-colors duration-300 shadow-md">æª¢æŸ¥ç­”æ¡ˆ</button>
            <button id="shuffle-btn" class="flex-grow text-white sm:flex-grow-0 font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition-colors duration-300 shadow-md">é‡æ–°æ’åˆ—</button>
            <button id="show-btn" class="flex-grow sm:flex-grow-0 font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition-colors duration-300 shadow-md">é¡¯ç¤ºç­”æ¡ˆ</button>
            <button id="next-btn" class="flex-grow text-white sm:flex-grow-0 font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition-colors duration-300 shadow-md">ä¸‹ä¸€é¡Œ</button>
        </div>
    </div>

    <script>
        // --- è³‡æ–™åº«ï¼šå­˜æ”¾æ‰€æœ‰ç¶“æ–‡ ---
        const verses = [
            // --- Day 1-10 ---
            { reference: "ç´„ç¿°ç¦éŸ³ 3:16", text: "ç¥ æ„› ä¸–äºº ï¼Œ ç”šè‡³ å°‡ ç¥‚çš„ ç¨ç”Ÿå­ è³œçµ¦ ä»–å€‘ ï¼Œ å« ä¸€åˆ‡ ä¿¡ ç¥‚ çš„ ï¼Œ ä¸è‡´ æ»…äº¡ ï¼Œ åå¾— æ°¸ç”Ÿ ã€‚" },
            { reference: "å“¥æ—å¤šå¾Œæ›¸ 5:17", text: "è‹¥ æœ‰äºº åœ¨ åŸºç£ è£ ï¼Œ ä»– å°±æ˜¯ æ–°é€ çš„ äºº ï¼Œ èˆŠäº‹ å·²é ï¼Œ éƒ½ è®Šæˆ æ–°çš„ äº† ã€‚" },
            { reference: "é¦¬å¤ªç¦éŸ³ 11:28", text: "å‡¡ å‹è‹¦ æ“”é‡æ“”çš„ äºº å¯ä»¥ åˆ° æˆ‘ é€™è£ ä¾† ï¼Œ æˆ‘å°± ä½¿ ä½ å€‘ å¾— å®‰æ¯ ã€‚" },
            { reference: "é¦¬å¤ªç¦éŸ³ 6:34", text: "æ‰€ä»¥ ï¼Œ ä¸è¦ ç‚º æ˜å¤© æ†‚æ…® ï¼Œ å› ç‚º æ˜å¤© è‡ªæœ‰ æ˜å¤©çš„ æ†‚æ…® ï¼› ä¸€å¤©çš„ é›£è™• ä¸€å¤© ç•¶ å°±å¤  äº† ã€‚" },
            { reference: "é¦¬å¤ªç¦éŸ³ 7:7-8", text: "ä½ å€‘ ç¥ˆæ±‚ ï¼Œ å°± çµ¦ ä½ å€‘ ï¼› å°‹æ‰¾ ï¼Œ å°± å°‹è¦‹ ï¼› å©é–€ ï¼Œ å°± çµ¦ ä½ å€‘ é–‹é–€ ã€‚ å› ç‚º å‡¡ ç¥ˆæ±‚çš„ ï¼Œ å°± å¾—è‘— ï¼› å°‹æ‰¾çš„ ï¼Œ å°± å°‹è¦‹ ï¼› å©é–€çš„ ï¼Œ å°± çµ¦ä»– é–‹é–€ ã€‚" },
            { reference: "ä»¥å¼—æ‰€æ›¸ 6:2-3", text: "ã€Œ è¦ å­æ•¬ çˆ¶æ¯ ï¼Œ ä½¿ ä½  å¾— ç¦ ï¼Œ åœ¨ä¸– é•·å£½ ã€‚ ã€ é€™ æ˜¯ ç¬¬ä¸€æ¢ å¸¶ æ‡‰è¨±çš„ èª¡å‘½ ã€‚" },
            { reference: "ç®´è¨€ 9:10", text: "æ•¬ç• è€¶å’Œè¯ æ˜¯ æ™ºæ…§çš„ é–‹ç«¯ ï¼› èªè­˜ è‡³è–è€… ä¾¿æ˜¯ è°æ˜ ã€‚" },
            { reference: "é›…å„æ›¸ 4:7-8", text: "å‹™è¦ æŠµæ“‹ é­”é¬¼ ï¼Œ é­”é¬¼ å°± å¿… é›¢é–‹ ä½ å€‘ é€ƒè·‘äº† ã€‚ ä½ å€‘ è¦ªè¿‘ ç¥ ï¼Œ ç¥ å°± å¿… è¦ªè¿‘ ä½ å€‘ ã€‚" },
            { reference: "é¦¬å¤ªç¦éŸ³ 4:4", text: "ç¶“ä¸Š è¨˜è‘— èªª ï¼š äºº æ´»è‘— ï¼Œ ä¸æ˜¯ å–®é  é£Ÿç‰© ï¼Œ ä¹ƒæ˜¯ é  ç¥ å£ è£ æ‰€å‡ºçš„ ä¸€åˆ‡ è©± ã€‚" },
            { reference: "è©©ç¯‡ 119:105", text: "ç¥¢çš„ è©± æ˜¯ æˆ‘ è…³å‰çš„ ç‡ˆ ï¼Œ æ˜¯ æˆ‘ è·¯ä¸Šçš„ å…‰ ã€‚" },
            // --- Day 11-20 ---
            { reference: "è…“ç«‹æ¯”æ›¸ 4:6-7", text: "æ‡‰ç•¶ ä¸€ç„¡ æ›æ…® ï¼Œ åªè¦ å‡¡äº‹ è—‰è‘— ç¦±å‘Š ã€ ç¥ˆæ±‚ ï¼Œ å’Œ æ„Ÿè¬ ï¼Œ å°‡ ä½ å€‘ æ‰€è¦çš„ å‘Šè¨´ ç¥ ã€‚ ç¥ æ‰€è³œ å‡ºäººæ„å¤–çš„ å¹³å®‰ ï¼Œ å¿… åœ¨ åŸºç£ è€¶ç©Œ è£ ä¿å®ˆ ä½ å€‘çš„ å¿ƒæ‡·æ„å¿µ ã€‚" },
            { reference: "è©©ç¯‡ 23:1-3", text: "è€¶å’Œè¯ æ˜¯ æˆ‘çš„ ç‰§è€… ï¼Œ æˆ‘ å¿… ä¸è‡´ ç¼ºä¹ ã€‚ ç¥‚ ä½¿ æˆ‘ èººè‡¥ åœ¨ é’è‰ åœ°ä¸Š ï¼Œ é ˜ æˆ‘ åœ¨ å¯ å®‰æ­‡çš„ æ°´é‚Š ã€‚ ç¥‚ ä½¿ æˆ‘çš„ éˆé­‚ ç”¦é†’ ï¼Œ ç‚º è‡ªå·±çš„ å å¼•å° æˆ‘ èµ° ç¾©è·¯ ã€‚" },
            { reference: "é¦¬å¤ªç¦éŸ³ 16:26", text: "äºº è‹¥ è³ºå¾— å…¨ä¸–ç•Œ ï¼Œ è³ ä¸Š è‡ªå·±çš„ ç”Ÿå‘½ ï¼Œ æœ‰ ç”šéº¼ ç›Šè™• å‘¢ ï¼Ÿ äºº é‚„èƒ½ æ‹¿ ç”šéº¼ æ› ç”Ÿå‘½ å‘¢ ï¼Ÿ" },
            { reference: "ç´„ç¿°ä¸€æ›¸ 1:9", text: "æˆ‘å€‘ è‹¥ èª è‡ªå·±çš„ ç½ª ï¼Œ ç¥ æ˜¯ ä¿¡å¯¦çš„ ï¼Œ æ˜¯ å…¬ç¾©çš„ ï¼Œ å¿…è¦ èµ¦å… æˆ‘å€‘çš„ ç½ª ï¼Œ æ´—æ·¨ æˆ‘å€‘ ä¸€åˆ‡çš„ ä¸ç¾© ã€‚" },
            { reference: "ä»¥è³½äºæ›¸ 53:5", text: "ç¥‚ ç‚º æˆ‘å€‘çš„ éçŠ¯ å—å®³ ï¼Œ ç‚º æˆ‘å€‘çš„ ç½ªå­½ å£“å‚· ã€‚ å›  ç¥‚ å—çš„ åˆ‘ç½° ï¼Œ æˆ‘å€‘ å¾— å¹³å®‰ ï¼› å›  ç¥‚ å—çš„ é­å‚· ï¼Œ æˆ‘å€‘ å¾— é†«æ²» ã€‚" },
            { reference: "å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸ 5:16-18", text: "è¦ å¸¸å¸¸ å–œæ¨‚ ï¼Œ ä¸ä½åœ° ç¦±å‘Š ï¼Œ å‡¡äº‹ è¬æ© ï¼› å› ç‚º é€™ æ˜¯ ç¥ åœ¨ åŸºç£ è€¶ç©Œ è£ å‘ ä½ å€‘ æ‰€å®šçš„ æ—¨æ„ ã€‚" },
            { reference: "ç´„ç¿°ç¦éŸ³ 14:16-17a", text: "æˆ‘ è¦æ±‚ çˆ¶ ï¼Œ çˆ¶ å°± å¦å¤– è³œçµ¦ ä½ å€‘ ä¸€ä½ ä¿æƒ å¸« ï¼Œ å« ç¥‚ æ°¸é  èˆ‡ ä½ å€‘ åŒåœ¨ ï¼Œ å°±æ˜¯ çœŸç†çš„ è–éˆ ã€‚" },
            { reference: "åŠ æ‹‰å¤ªæ›¸ 5:22-23a", text: "è–éˆ æ‰€çµçš„ æœå­ ï¼Œ å°±æ˜¯ ä»æ„› ã€ å–œæ¨‚ ã€ å’Œå¹³ ã€ å¿è€ ã€ æ©æ…ˆ ã€ è‰¯å–„ ã€ ä¿¡å¯¦ ã€ æº«æŸ” ã€ ç¯€åˆ¶ ã€‚" },
            { reference: "å“¥æ—å¤šå‰æ›¸ 13:4-8a (ä¸Š)", text: "æ„› æ˜¯ æ†ä¹… å¿è€ ï¼Œ åˆæœ‰ æ©æ…ˆ ï¼› æ„› æ˜¯ ä¸ å«‰å¦’ ï¼› æ„› æ˜¯ ä¸ è‡ªèª‡ ï¼Œ ä¸ å¼µç‹‚ ï¼Œ ä¸ä½œ å®³ç¾çš„ äº‹ ï¼Œ ä¸æ±‚ è‡ªå·±çš„ ç›Šè™• ï¼Œ ä¸è¼•æ˜“ ç™¼æ€’ ï¼Œ ä¸ è¨ˆç®— äººçš„ æƒ¡ ï¼Œ ä¸ å–œæ­¡ ä¸ç¾© ï¼Œ åª å–œæ­¡ çœŸç† ã€‚" },
            { reference: "å“¥æ—å¤šå‰æ›¸ 13:4-8a (ä¸‹)", text: "å‡¡äº‹ åŒ…å®¹ ï¼Œ å‡¡äº‹ ç›¸ä¿¡ ï¼Œ å‡¡äº‹ ç›¼æœ› ï¼Œ å‡¡äº‹ å¿è€ ã€‚ æ„› æ˜¯ æ°¸ä¸ æ­¢æ¯ ã€‚" },
            { reference: "é¦¬å¤ªç¦éŸ³ 7:12a", text: "æ‰€ä»¥ ï¼Œ ç„¡è«– ä½•äº‹ ï¼Œ ä½ å€‘ é¡˜æ„ äºº æ€æ¨£ å¾… ä½ å€‘ ï¼Œ ä½ å€‘ ä¹Ÿ è¦ æ€æ¨£ å¾…äºº ã€‚" },
            { reference: "å“¥æ—å¤šå¾Œæ›¸ 12:9", text: "ç¥‚ å° æˆ‘ èªª ï¼š ã€Œ æˆ‘çš„ æ©å…¸ å¤  ä½  ç”¨çš„ ï¼Œ å› ç‚º æˆ‘çš„ èƒ½åŠ› æ˜¯ åœ¨ äººçš„ è»Ÿå¼±ä¸Š é¡¯å¾— å®Œå…¨ ã€‚ ã€ æ‰€ä»¥ ï¼Œ æˆ‘ æ›´ å–œæ­¡ èª‡ è‡ªå·±çš„ è»Ÿå¼± ï¼Œ å¥½å« åŸºç£çš„ èƒ½åŠ› è¦†åº‡ æˆ‘ ã€‚" },
            { reference: "å“¥æ—å¤šå‰æ›¸ 10:13", text: "ä½ å€‘ æ‰€é‡è¦‹çš„ è©¦æ¢ ï¼Œ ç„¡éæ˜¯ äºº æ‰€èƒ½ å—çš„ ã€‚ ç¥ æ˜¯ ä¿¡å¯¦çš„ ï¼Œ å¿… ä¸å« ä½ å€‘ å— è©¦æ¢ éæ–¼ æ‰€èƒ½ å—çš„ ï¼› åœ¨ å— è©¦æ¢çš„ æ™‚å€™ ï¼Œ ç¸½è¦ çµ¦ ä½ å€‘ é–‹ ä¸€æ¢ å‡ºè·¯ ï¼Œ å« ä½ å€‘ èƒ½ å¿å—å¾—ä½ ã€‚" },
            // --- Day 21-30 ---
            { reference: "ç´„ç¿°ç¦éŸ³ 8:12", text: "è€¶ç©Œ åˆ å° çœ¾äºº èªª ï¼š ã€Œ æˆ‘ æ˜¯ ä¸–ç•Œçš„ å…‰ ã€‚ è·Ÿå¾ æˆ‘çš„ ï¼Œ å°± ä¸åœ¨ é»‘æš—è£ èµ° ï¼Œ å¿…è¦ å¾—è‘— ç”Ÿå‘½çš„ å…‰ ã€‚ ã€" },
            { reference: "ç¾…é¦¬æ›¸ 8:28", text: "æˆ‘å€‘ æ›‰å¾— è¬äº‹ éƒ½ äº’ç›¸ æ•ˆåŠ› ï¼Œ å« æ„› ç¥çš„ äºº å¾— ç›Šè™• ï¼Œ å°±æ˜¯ æŒ‰ ä»– æ—¨æ„ è¢« å¬çš„ äºº ã€‚" },
            { reference: "ä»¥è³½äºæ›¸ 40:31", text: "ä½† é‚£ ç­‰å€™ è€¶å’Œè¯çš„ å¿… é‡æ–° å¾—åŠ› ã€‚ ä»–å€‘ å¿… å¦‚ é·¹ å±•ç¿… ä¸Šé¨° ï¼› ä»–å€‘ å¥”è·‘ å» ä¸ å›°å€¦ ï¼Œ è¡Œèµ° å» ä¸ ç–²ä¹ ã€‚" },
            { reference: "ç®´è¨€ 3:5-6", text: "ä½  è¦ å°ˆå¿ƒ ä»°è³´ è€¶å’Œè¯ ï¼Œ ä¸å¯ å€šé  è‡ªå·±çš„ è°æ˜ ï¼Œ åœ¨ ä½  ä¸€åˆ‡ æ‰€è¡Œçš„ äº‹ä¸Š éƒ½ è¦ èªå®š ç¥‚ ï¼Œ ç¥‚ å¿… æŒ‡å¼• ä½ çš„ è·¯ ã€‚" },
            { reference: "ç´„ç¿°ç¦éŸ³ 14:21", text: "æœ‰äº† æˆ‘çš„ å‘½ä»¤ åˆ éµå®ˆçš„ ï¼Œ é€™ äºº å°±æ˜¯ æ„› æˆ‘çš„ ï¼› æ„› æˆ‘çš„ å¿… è’™ æˆ‘ çˆ¶ æ„› ä»– ï¼Œ æˆ‘ ä¹Ÿ è¦ æ„› ä»– ï¼Œ ä¸¦ä¸” è¦ å‘ ä»– é¡¯ç¾ ã€‚" },
            { reference: "åŠ æ‹‰å¤ªæ›¸ 2:20a", text: "æˆ‘ å·²ç¶“ èˆ‡ åŸºç£ åŒé‡˜ åå­—æ¶ ï¼Œ ç¾åœ¨ æ´»è‘—çš„ ä¸å†æ˜¯ æˆ‘ ï¼Œ ä¹ƒæ˜¯ åŸºç£ åœ¨ æˆ‘ è£é¢ æ´»è‘— ã€‚" },
            { reference: "ç´„ç¿°ç¦éŸ³ 14:6", text: "è€¶ç©Œ èªª ï¼š ã€Œ æˆ‘ å°±æ˜¯ é“è·¯ ã€ çœŸç† ã€ ç”Ÿå‘½ ï¼› è‹¥ä¸ è—‰è‘— æˆ‘ ï¼Œ æ²’æœ‰ äºº èƒ½ åˆ° çˆ¶ é‚£è£ å» ã€‚ ã€" },
            { reference: "è©©ç¯‡ 121:7-8", text: "è€¶å’Œè¯ è¦ ä¿è­· ä½  ï¼Œ å…å— ä¸€åˆ‡çš„ ç½å®³ ï¼› ç¥‚ è¦ ä¿è­· ä½ çš„ æ€§å‘½ ã€‚ ä½  å‡º ä½  å…¥ ï¼Œ è€¶å’Œè¯ è¦ ä¿è­· ä½  ï¼Œ å¾ ä»Šæ™‚ ç›´åˆ° æ°¸é  ã€‚" }
        ];

        // --- DOM å…ƒç´ ç²å– ---
        const verseReferenceEl = document.getElementById('verse-reference');
        const verseDisplayEl = document.getElementById('verse-display');
        const messageAreaEl = document.getElementById('message-area');
        const checkBtn = document.getElementById('check-btn');
        const showBtn = document.getElementById('show-btn');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const verseSelectEl = document.getElementById('verse-select');
        const shuffleBtn = document.getElementById('shuffle-btn');

        // --- éŠæˆ²ç‹€æ…‹è®Šæ•¸ ---
        let currentVerseIndex = -1;
        let correctAnswers;

        /**
         * å¡«å……ç¶“æ–‡é¸æ“‡ä¸‹æ‹‰é¸å–®
         */
        function populateVerseSelector() {
            verseSelectEl.innerHTML = '';
            verses.forEach((verse, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = verse.reference;
                verseSelectEl.appendChild(option);
            });
        }
        
        /**
         * æ ¹æ“šç´¢å¼•è¼‰å…¥æŒ‡å®šçš„ç¶“æ–‡é¡Œç›®
         * @param {number} index - è¦è¼‰å…¥çš„ç¶“æ–‡åœ¨ verses é™£åˆ—ä¸­çš„ç´¢å¼•
         */
        function loadVerse(index) {
            if (index < 0 || index >= verses.length) return; 
            
            currentVerseIndex = index;
            const currentVerse = verses[currentVerseIndex];
            const words = currentVerse.text.split(' ');

            correctAnswers = new Map();
            verseDisplayEl.innerHTML = '';
            messageAreaEl.textContent = '';
            verseReferenceEl.textContent = currentVerse.reference;
            verseSelectEl.value = currentVerseIndex;

            const punctuation = ['ï¼Œ', 'ã€‚', 'ã€', 'ï¼š', 'ï¼›', 'ï¼Ÿ', 'ï¼', 'ã€Œ', 'ã€'];
            const wordIndices = words.map((_, i) => i).filter(i => !punctuation.includes(words[i]));
            const countToHide = Math.ceil(wordIndices.length * 0.4);
            
            for (let i = wordIndices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [wordIndices[i], wordIndices[j]] = [wordIndices[j], wordIndices[i]];
            }
            const hiddenIndices = new Set(wordIndices.slice(0, countToHide));

            words.forEach((word, idx) => {
                const isHidden = hiddenIndices.has(idx);

                if (isHidden) {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.classList.add('input-blank');
                    input.setAttribute('data-index', idx);
                    input.style.width = `${word.length * 1.6 + 1}em`;
                    input.maxLength = word.length;
                    input.placeholder = 'ã€‡'.repeat(word.length);
                    verseDisplayEl.appendChild(input);
                    correctAnswers.set(idx.toString(), word);
                } else {
                    const textSpan = document.createElement('span');
                    textSpan.style.display = 'inline-block';
                    textSpan.textContent = word;
                    verseDisplayEl.appendChild(textSpan);
                }
                
                if (idx < words.length - 1) {
                   verseDisplayEl.appendChild(document.createTextNode(' '));
                }
            });
             
            updateButtonStates();
        }
        
        function updateButtonStates() {
            checkBtn.disabled = false;
            showBtn.disabled = false;
            shuffleBtn.disabled = false;
            prevBtn.disabled = currentVerseIndex <= 0;
            nextBtn.disabled = currentVerseIndex >= verses.length - 1;
        }

        function checkAnswers() {
            const inputs = verseDisplayEl.querySelectorAll('input');
            let allCorrect = true;

            inputs.forEach(input => {
                const index = input.getAttribute('data-index');
                const correctAnswer = correctAnswers.get(index);
                
                input.classList.remove('correct-answer', 'incorrect-answer');
                if (input.value.trim() === correctAnswer) {
                    input.classList.add('correct-answer');
                } else {
                    input.classList.add('incorrect-answer');
                    allCorrect = false;
                }
            });

            if (allCorrect) {
                messageAreaEl.textContent = 'æ­å–œï¼å…¨éƒ¨ç­”å°äº†ï¼ğŸ‰';
                messageAreaEl.style.color = 'var(--correct-green)';
                checkBtn.disabled = true;
                showBtn.disabled = true;
            } else {
                messageAreaEl.textContent = 'æœ‰äº›åœ°æ–¹éŒ¯äº†å–”ï¼Œå†è©¦è©¦çœ‹ï¼';
                messageAreaEl.style.color = 'var(--incorrect-red)';
            }
        }

        function showAnswers() {
            const inputs = verseDisplayEl.querySelectorAll('input');
            inputs.forEach(input => {
                const index = input.getAttribute('data-index');
                input.value = correctAnswers.get(index);
                input.classList.remove('incorrect-answer');
                input.classList.add('correct-answer');
            });
            messageAreaEl.textContent = 'ç­”æ¡ˆå·²ç¶“é¡¯ç¤ºå›‰ï¼';
            messageAreaEl.style.color = 'var(--text-primary)';
            checkBtn.disabled = true;
            showBtn.disabled = true;
        }

        // --- äº‹ä»¶ç›£è½ ---
        checkBtn.addEventListener('click', checkAnswers);
        showBtn.addEventListener('click', showAnswers);
        nextBtn.addEventListener('click', () => loadVerse(currentVerseIndex + 1));
        prevBtn.addEventListener('click', () => loadVerse(currentVerseIndex - 1));
        verseSelectEl.addEventListener('change', (e) => loadVerse(parseInt(e.target.value, 10)));
        shuffleBtn.addEventListener('click', () => loadVerse(currentVerseIndex));

        // --- åˆå§‹å•Ÿå‹• ---
        window.onload = () => {
            populateVerseSelector();
            const startingIndex = Math.floor(Math.random() * verses.length);
            loadVerse(startingIndex);
        };
    </script>
</body>
</html>
